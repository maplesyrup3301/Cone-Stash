$$
\def\d{\text d} 
\def\b{\boldsymbol}
\def\o{\overline}
$$
# 数制与码制
## 数制
给定一个基数$S\geq2(S\in\mathbb{N_+})$，则任何实数$P$都可以唯一表示为和：
$$
P=\sum_{n=0}^\infty p_nS^n+\sum_{n=1}^\infty q_nS^{-n}
$$
取该和的系数将$P$表示为$P=(\overline{\dots p_i\dots p_2p_1p_0.q_0q_1q_2\dots q_k\dots})_S$，此种数字表示系统称为$S$进制；
为了叙述方便，本文将数$x$变换为其$S$进制表示$\o x$的映射记为：
$$
B_S:x\mapsto \o x_S
$$
虽然数本身的含义是恒定的，但是在不同数制中的表示不同，为了表示方便本文记十进制所表示的数为$[\o x_{10}]$，也即$[27]$表示数$27$本身，独立于任何进制；
由于二稳态元件的抗噪音能力强，在数字电路设计中我们使用二进制
十进制转换为二进制的通法是：连续使用带余除法将原数除以二直到被除数为零，随后将余数自下向上，自左向右排列得到原数的二进制表示；以$[27]$为例：
$$
\begin{aligned}[]
[28]\div[2]=[14]\cdots[0]\\
[14]\div[2]=[7]\cdots[0]\\
[7]\div[2]=[3]\cdots[1]\\
[3]\div[2]=[1]\cdots[1]\\
[1]\div[2]=[0]\cdots[1]\\
\Rightarrow (28)_{10}=(11100)_2
\end{aligned}
$$
给定一个固定长度为$N$的二进制数$B$，其可以的表示状态为全零到全一之间的任意状态；固定长度的二进制数溢出时舍弃数的最高位；
二进制数$B$代表了模$2^N$的一个整数加群的一个子群的代表元；因此
$$
\dot B_{2}(-k)\equiv \dot B_2(s\cdot2^N-k)(s\in\mathbb{Z})
$$
同时考察按位取反操作，发现对二进制数$K[k]$有关系$L[2^N-k-1]\equiv\ominus K$
综上我们得出：$\dot B_2(-k)\equiv \ominus K\oplus 1$；这就是负数的**补码**；这样我们便可以用加法计算减法了；
对于3位定长二进制数，其表如下：

| 编码  | 直读  | 补码对应数 |
| --- | --- | ----- |
| 000 | 0   | -8, 0 |
| 001 | 1   | -7, 1 |
| 010 | 2   | -6, 2 |
| 011 | 3   | -5, 3 |
| 100 | 4   | -4, 4 |
| 101 | 5   | -3, 5 |
| 110 | 6   | -2, 6 |
| 111 | 7   | -1, 7 |
而一般有符号数就以最高位为符号位，按符号取最小的补码对应数
## 码制
然而数的表示并不局限于数制转换产生的自然码制；通过人为重载数码的含义我们可以得到各种不同的码制，因其特性不同它们分别适用于不同的场景
下面是一些常见的编码：
### 十进制编码
十进制编码是满足自$0$至$9$的十进制数码进行编码的码制；
#### 恒权码
恒权码通过赋予每一位不同的恒权来表示数字，如8421码、2421码、5211码，其名称分别表示每一位数码所代表的值；
8421码就是二进制自然编码，又称BCD（Binary Coded Decimal）
#### 余3码
余3码按自然码制读出的数总比其所表示的数大3，例如$0$以$(0011)$表示；
余3码所代表的映射为：

$$
R_3: x\mapsto B_2(x+[3])
$$
余3码的特点：
1. （自动十进制进位）如果有$x+y=[10]$，则有：
$$
R_3(x)\oplus R_3(y)=B_2(x+y+[6])=B_2([16])=(10000)_2
$$
表示两数相加如果满十进位，则其余3码表示之和也自动进位到第5位；
2. （对10取补码就等于其反码）如果有$x+y=[9]$，则有：
$$
R_3(x)=R_3([9]-y)=B_2([12]-y)=-B_2(y+[3])=-R_3(y)
$$
这是由上面性质（1）自然得到的性质；
#### 格雷码
格雷码的特点是相邻数的编码间仅有一位数码不同；在卡诺图中有应用
要得到格雷码，用相应位置的取反代替重复的加一即可
# 逻辑运算
布尔代数中变量的值仅取$0$或$1$，包含有三种基本运算（逻辑门）：
1. 与（$A\cdot B$）：当且仅当$A, B$均为真时为真
2. 或（$A+B$）：当且仅当$A, B$均为假时为假
3. 非（$A'$）：$A$的逻辑值取反
通过组合运算，可以得到更多复杂的门
以下是一些基本公式：
- 与运算
$$
0\cdot A=0; 1\cdot A=A; A\cdot A=A; A\cdot A'=0
$$
与运算满足交换律，结合律 和 关于或运算的分配律
- 或运算
$$
0+A=A; 1+A=1; A+A=A; A+A'=1
$$
或运算满足交换律，结合律 和 关于与运算的分配律

**逻辑代数基本定理**：
1. 代入定理：任何逻辑式都是相等的，将等式中的变量代换为逻辑式等式依然成立
2. 反演定理：将逻辑式中的与、或互换，真、假互换，$1$、$0$互换，变量全部取反，就得到原逻辑式的取反
3. 对偶定理：将逻辑式中的与、或互换，真、假互换，$1$、$0$互换就得到原式的对偶式

对于逻辑函数$F(b_1, b_2\dots b_n)$，若将一个变量$b$或其反变量$b'$合记为$B$，记输入序列$S=\overline {b_1b_2\dots b_n}$
1. 形如$B_1B_2\dots B_n$的d为最小项
不难发现$n$项最小项有$2^n$个；
因为最小项全以与连接，故而只有当每一个变量或反变量为真时才为真，因此变量、反变量序列与一个输入序列一一对应，每个最小项仅当接受对应的输入序列时为真；例如$\overline{b_1b_2'b_3b_4}$对应输入序列$1011$.
注意到我们可以把单个变量展开为最小项：
$$
b_1=b_1(b_2+b_2')(b_3+b_3')\dots(b_n+b_n')
$$
因此可以把任意式子展开为最小项之和（SOP）的形式
从而每一项最小项对应的输入序列之集合就是该函数的真值集合

2. 形如$B_1+B_2+\dots+B_n$的为最大项
不难发现$n$项最大项有$2^n$个；
因为最大项全以或连接，故而只有当每一个变量或反变量为假时才为假，因此变量、反变量序列与一个输入序列一一对应，每个最大项仅当接受对应的输入序列时为假
注意到我们可以把单个变量展开为最大项：
$$
b_1=b_1+(b_2b_2')+(b_3b_3')+\dots+(b_nb_n')
$$
因此可以把任意式子展开为最大项之积（POS）的形式
从而每一项最大项对应的输入序列之集合就是该函数的假值集合

例如函数$F(A, B, C)=A'B+AB'C+BC'$可以展开为：
$$
F(A, B, C)=A'BC+A'BC'+AB'C+ABC'
$$
或者：
$$
F(A, B, C)=(A+B+C)(A'+B'+C)(A+B'+C')(A'+B'+C')
$$

联系二者的是**德摩根公式**
$$
(b_1b_2\dots b_n)'=b_1'+b_2'+\dots+b_n'
$$

又例如函数：$F(A, B)=A'+AB'+B$可以展开为：
$$
F(A, B)=A'B+A'B'+AB'+AB+A'B=AB+A'B+AB'+A'B'
$$
这说明$F(A, B)= 1$

逻辑式的标准形式或是最大项、最小项形式，或是与或形式，也就是最简乘积之和形式；下面我们介绍化简逻辑式的方法：
- 公式法：
1. $AB+AB'=A$
2. $A+AB=A$
3. $AB+A'C+BC=AB+A'C$
5. $A+A'B=A+B$
6. $A+A=A$
7. $A+A'=1$
公式法就是利用以上公式进行变换化简；
- 卡诺图法：
卡诺图是一种特别的真值表，其纵横方向上各输入采取的是格雷码表示，从而使得在表上邻近的格在逻辑上也是相邻的，从而可以依靠把图中的真值分划为方格的方法化简原式；
对于其中的无关项，可以在卡诺图中任意以真或假代替，应当代入合理的真值使卡诺图中的方框最大化。

与此同时，需要注意到现实中我们往往仅能使用一种门，门的输入也往往只有两个，这就需要我们作另外的变换，将其全部化为一种门。
# 门电路
## CMOS 门电路
### MOS管
#### MOS管的输入特性与输出特性
考虑N沟道增强型MOS管的共源极电路：
```tikz
\usepackage{circuitikz}
\begin{document}
\begin{circuitikz}[american]

\draw (1, 0) node[nigfete, anchor=G](nfet1){}
(nfet1.gate) node[anchor=north east] {G}
(nfet1.drain) node[anchor=south east] {D}
(nfet1.source) node[anchor=north east] {S};
\draw (0, 0) -- (nfet1.gate);
\draw (0, 0) to[short, *-] ++(0, 0);
\draw (0, -1)  -| (nfet1.source);
\draw (0, -1) to[short, *-] ++(0, 0);
\draw (4, -1) -| (nfet1.source);
\draw (4, -1) to[short, *-] ++(0, 0);
\draw (4, 1) -| (nfet1.drain);
\draw (4, 1) to[short, *-] ++(0, 0);
\draw (0, 0) to[open, v=$v_{GS}$] (0, -1);
\draw (4, 1) to[open, v=$v_{DS}$] (4, -1);
\draw (4, 1) to[short, i=$i_D$] (4, 1-|nfet1.drain);
\draw (4, -1-|nfet1.source) node[ground]{};
\end{circuitikz}
\end{document}
```
当$v_{GS}<V_{GS(th)}$时MOS管处于截止状态，无导电沟道形成因此无电流通过，此区域称为截止区；
当$v_{GS}>V_{GS(th)}$时MOS管处于导通状态，导电沟道形成并且随着$v_{GS}$的增大而拓宽：
	在$v_{DS}$较小时电流小于导电沟道的最大承载量，$i_D$与$v_{DS}$成正比，此时MOS管近似于一个电阻，其阻值随着$v_{GS}$的增大而减小；此区域称为可变电阻区
	在$v_{DS}$较大时电流大于导电沟道的最大承载量，$i_D$随着$v_{DS}$的增大趋近于饱和电流；该饱和电流随着$v_{GS}$的增大而增大；此区域称为恒流区
$v_{DS}$对$v_{GS(th)}$的影响不大；
#### MOS管基本开关电路
![[增强型NMOS.png]]
当$v_I<V_{GS(th)}$时，MOS管截止，因此输出$v_O=+V_{DD}$为高电平；
当$v_I>V_{GS(th)}$时，MOS管导通进入恒流区，如果$v_I$取较大则导通内阻$R_{ON}$较小；
若$R_D\gg R_{ON}$，则输出$v_O\approx 0$为低电平；
![[MOS管的等效.png]]
MOS管分为：
1. P型：栅极接负压
2. N型：栅极接正压
以及：
1. 增强型：默认截止，栅极电压增大后导通
2. 耗尽型：默认导通，栅极电压减小后截止
记忆口诀是：
NP相反（N型栅极却接正压，P型栅极接负压）
入不负出
### CMOS 反相器
CMOS反相器的结构如图所示：
![[CMOS反相器.png]]
注意到反相器不是几个独立MOS管形成的电路，而是在同一块半导体上制作的
因此后面我们还需要考虑到CMOS反相器内部寄生的三极管

已知$T_1, T_2$的开启电压为$V_{GS(th)P},V_{GS(th)N}$；令$V_{DD}>V_{GS(th)P}+|V_{GS(th)N}|$
若$v_1=0$时：
$v_{GS1}=-V_{DD}<V_{GS(th)N}$，$T_1$导通；
$v_{GS2}=0<V_{GS(th)P}$，$T_2$截止；
因此$v_O\approx V_{DD}$为高电平
若$v_1=V_{DD}$时：
$v_{GS1}=0>V_{GS(th)N}$，$T_1$截止；
$v_{GS2}=V_{DD}>V_{GS(th)P}$，$T_2$导通；
因此$v_{O}\approx0$为低电平
![[CMOS反相器的电压特性.png|250]]![[CMOS反相器的电流特性.png|250]]
由图可以看出，反相器在$v_I=0.5V_{DD}$时也输出$0.5V_{DD}$，此时两管内阻相等，该电压称为反相器的阈值电压；
在高电平或低电平区间内，由于截止管的内阻巨大，因此电流都很小；而在过渡区两管内阻大小都中等，因此电流大；因此我们一般希望反相器工作在高电平或者低电平区，否则MOS管可能因功耗大而损坏；
在保证输出电平波动不大的条件下，输入端电平的允许波动范围称为输入端的噪声容限；考虑门电路级间传递的电平，可知噪声容限的公式：
$$
V_{NH}=V_{OH(min)}-V_{IH(min)}, V_{NL}=V_{IL(max)}-V_{OL(max)}
$$
在CMOS门电路中，当负载为门电路的情况下我们规定：
$V_{OH(min)}=V_{DD}-0.1\text V, V_{OL(max)}=V_{SS}+0.1\text V$
其中$V_{SS}$表示反相器中N沟道管的源极电压；
#### CMOS反相器的静态特性
##### 输入特性
MOS管的运作需要形成电场：中间的栅极之所以能够吸引载流子，就是因为与基底形成了电容；因为氧化物薄膜非常薄，保护MOS管实质上就是保护这个微小电容不被击穿；
实际生产的各种反相器都采用了输入保护措施，简而言之就是在输入端加上一对钳位二极管；尽管如此，在极大的电流下MOS管仍可能被击穿，因此仍然须要注意正确使用MOS管；
![[CMOS反相器的输入保护.png]]
当$-V_{SS}-0.7\text V < v_I < V_{DD}+0.7\text V$时，电路正常工作，此时等效为(c)图
当$v_I$超过上下钳位阈值，二极管导通且电流迅速增大，此时电流主要经过二极管
![[CMOS反相器的输入特性.png|400]]
##### 输出特性
1. 低电平输出特性
输入为高电平时，$T_N$导通，$T_P$截止，此时$v_O=i_{O}R_{on}$
其中$R_{on}$就是可变电阻区内此情况下$T_N$的等效电阻
2. 高电平输出特性
输入为低电平时，$T_P$导通，$T_N$截止，此时$v_O=V_{DD}-i_{O}R_{on}$
其中$R_{on}$就是可变电阻区内此情况下$T_P$的等效电阻
#### CMOS反相器的动态特性
对于CMOS电路，有传输延迟时间$t_{PHL}=t_{PLH}$
反相器的交流噪声容限随着噪声脉冲作用时间的延长而减小，最后趋于稳定
在反相器状态转换过程中产生的功耗称为动态功耗
其中：
电容充放电产生的功耗：$P_C=C_LfV_{DD}^2$
过渡态产生的功耗：$P_T=C_{PD}fV_{DD}^2$
其中$C_{PD}$为厂家给出的功耗电容
动态功耗总的为：$P_D=P_T+P_C$
静态功耗$P_S$很小，因此一般只计算动态功耗
### 其他CMOS逻辑门
#### 与非门
其结构如下：
![[CMOS与非门.png|400]]
$T_2, T_4$组成了一个$N$-高阻与门，$T_1, T_3$组成了一个$P$-高阻或门
仅当$A=B=1$时，$T_2, T_4$同时导通，$T_1, T_3$同时截止，输出低电平；
上述电路的问题：
1. 不同输入，输出电阻不同；
2. 增加输入端数量会影响输出电平；
3. 输入状态不同时对电压传输特性有影响；
#### 或非门
其结构如下：
![[CMOS或非门.png|400]]
其分析与缺点都类似上述的与非门
为了改进上述门电路的缺点，实际中在每个输入、输出端都加入一个反相器作为缓冲级；此时原电路的逻辑功能也发生了变化
#### OD门
将CMOS门电路的输出级做成漏极开路的形式，称为漏极开路输出的门电路， 简称OD门；可实现输出电平的变换、输出大负载电流和“线与”等功能。
![[Pasted image 20241009172742.png|500]]
左图是OD输出与非门74HC03的结构；右图是其电路标志
菱形下的横线表示输出低电平时为低输出电阻；
OD门工作时需要将输出端经上拉电阻$R_L$接到高电平上
$T_N$的栅极所接信号为$AB$，而$T_N$与上拉电阻构成一个非门，因此总体是与非门
![[Pasted image 20241009174022.png|500]]
OD门的输出可以直接连接使用，此时各个输出端的MOS管组成了一个$N$-高阻或门，总的来看形成了线与连接，即$Y=Y_1Y_2$

OD门要求选取合适的上拉电阻$R_L$
![[Pasted image 20241009174159.png|600]]
当上一级输出高电平，流过$R_L$的电流是上一级所有漏电流和下一级所有输入端电流之和；设上一级有$n$个OD门，下一级有$m$个输入端；每个MOS管的漏电流为$I_{OH}$，每个输入端拉取电流为$I_{IH}$，要求输出电压不低于$V_{OH}$；可以求得$R_{L(max)}$
$$
R_L\leq\frac{V_{DD}-V_{OH}}{nI_{OH}+mI_{IH}}=R_{L(max)}
$$

当上一级输出低电平且只有一个NMOS导通，若允许的最大负载电流为$I_{OL(max)}$，下一级每个输入端的输入电流为$I_{IL}$，此时输出低电平$V_{OL}$；可以求得$R_{L(min)}$
$$
R_L\geq\frac{V_{DD}-V_{OL}}{I_{(OL)max}-m|I_{IL}|}=R_{L(min)}
$$
#### 传输门
利用NMOS和PMOS的互补性可以构造双向器件——传输门
![[Pasted image 20241009175229.png|500]]
$C$和$C'$是互补控制端：
当$C=1$时$C'=0$，此时两管均导通；
当$C=0$时$C'=1$，此时两管均截止
![[Pasted image 20241009175720.png|500]]
传输门的一个重要用途是作双向模拟开关
#### 三态门
![[Pasted image 20241009175835.png|500]]
当$EN'=0$，其功能等同于一个非门；当$EN'=1$时其输出高阻态
它常被用于电路的输出端，从而允许多个输出连接到同一根总线上，只要满足任何时刻没有两个三态门同时使能即可；
## TTL 门电路
### BJT管
#### BJT管的输入特性与输出特性
![[Pasted image 20241009180431.png|500]]
当$i_B=0$时，管子处在截止区，此时$i_C$几乎等于零，仅有微小的反向穿透电流流过；
当$i_B>0$时但$v_{CE}$较小时，管子收集电子的能力不如发射极发射电子的能力强，集电极饱和，因此处于饱和区
当$i_B>0$且$v_{CE}$较大时，管子收集电子的能力大于发射极发射电子的能力，此时电流就取决于发射极发射电子的能力，$i_C$几乎只受$i_B$的控制，且这种控制成正比
#### BJT基本开关电路
![[Pasted image 20241009181550.png|200]]
BJT管的基本开关电路如图；
当$v_I<V_{ON}$时，三极管截止，输出高电平；
当$v_I>V_{ON}$时，三极管逐渐导通；
当三极管深度导通，此时的输出电压$V_{CE(sat)}$和电阻$R_{CE(sat)}$
可以求出深度饱和电流：
$$
I_{BS}=\frac{V_{CC}-V_{CE(sat)}}{\beta(R_C+R_{CE(sat)})}\approx\frac{V_{CC}}{\beta R_{C}}
$$
此时的$\beta$比线性区要小且不是常数，因此取线性区的$\beta$计算会导致$I_{BS}$偏小
![[Pasted image 20241009182539.png|600]]
其等效如上图；
三极管内部电流的建立要滞后于电压的变化；
### TTL 反相器
下图是TTL反相器的电路结构：
![[Pasted image 20241009182724.png|300]]![[Pasted image 20241011152120.png|300]]
设电源电压$V_{CC}=5 \text{V}$，且$V_{IH}=3.4\text V, V_{IL}=0.2\text V$
认为开启电压$V_{ON}=0.7\text V$

无论输入高电平还是低电平，$T_1$均导通，因此有$v_{B2}=v_I$
- （截止区）当$v_I<0.6\text V$时，$T_2$截止：
$v_{B4}\approx 5\text V$，$T_4$导通；$v_{B5}=0$，$T_5$截止；
$v_{O}=v_{CC}-v_{R2}-2V_{ON}\approx3.4\text V$；
- （线性区）当$0.7\text V<v_I<1.3 \text V$时，$T_2$放大：
$$
v_{B4}=V_{CC}-\frac{R_2}{R_3}(v_I-0.7)=5-1.6(v_I-0.7)
$$
$T_4$导通
$v_{B5}=v_{B2}-0.7<V_{ON}$，$T_5$截止；
$v_O=4.72-1.6v_I$；
- （转折区）当$v_I=V_{TH}\approx 1.4\text V$时，$T_2$放大：
$v_{B5}\geq V_{ON}$，$T_5$导通；
$v_{B2}$被钳位至$1.4\text V$，而$v_{C2}\approx 0.7\sim 1\text V$，$T_2$饱和；
$v_{B4}=v_{C2}<1.4\text V$，因此$T_4$与$D_2$截止；
$v_O\approx 0.3\text V$
- （饱和区）当$v_I>V_{TH}$时，由于$v_{B1}=2.1\text V$（钳位），$T_1$的发射结截止（倒置）
此时$v_I$不再影响$v_O$，保持低电平输出

74系列的输入噪声容限为：

| 单位: V | 输入端 | 输出端 |
| :---: | :-: | :-: |
| 最高低电平 | 0.8 | 0.4 |
| 最低高电平 | 2.0 | 2.4 |
可见$V_{NH}=V_{NL}=0.4\text V$
#### TTL反相器的静态特性
##### 输入特性
![[Pasted image 20241011160957.png]]
当$V_{CC}=5\text V, v_I=V_{IL}$时，输入端低电平电流为：
$$
I_{IL}=-\frac{V_{CC}-v_{BE1}-V_{IL}}{R_1}\approx -1\text{mA}
$$
当$v_I=0$时的输入电流称为输入短路电流$I_IS$，比$I_IL$稍大，在近似计算时常常用输入短路电流代替输入低电平电流；

输入端高电平时$T_1$倒置，导致输入电流很小，74系列的$I_{IH}$在$40\mu\text{A}$以下

![[Pasted image 20241011162455.png]]
实际使用中，有时需要将输入端与大地或者低电平用电阻相连，由于输入电流是流出输入端的，因此电阻两端的电压会抬高输入电压；具体情况如图
- 当$R_P\leq 0.7\text {k}\ohm$时，构成低电平输入
- 当$R_P\geq 1.5\text k\ohm$时以及悬空时，构成高电平输入
##### 输出特性
1. 高电平输出特性
![[Pasted image 20241011161343.png]]
输出高电平时，随着输出电流增大，$R_4$两端的电压增大，$T_4$将进入饱和；由图可见此时电压几乎随着电流的增大线性减小
实际上，74系列门电路规定输出高电平时，最大负载电流不能超过$0.4\text {mA}$，若$V_{OH}=2.4\text V$，当$I_{OH}=-0.4\text {mA}$时内部消耗的功率已达1 mW
2. 低电平输出特性
![[Pasted image 20241011161726.png]]
输出低电平时，由于$T_5$的饱和导通电阻很低，因此仅随着电流的增大缓慢地线性增大；
#### TTL反相器的动态特性
由于寄生电容和结电容的存在，TTL门的平均传输延时为3~40 ns
另一方面，当输入极窄的脉冲式，由于响应不及，输出变化很小，因此交流噪声容限明显大于直流噪声容限：
![[Pasted image 20241011163225.png]]

在实际工作中，由于状态转换时导通必然先于截止，因此会存在一段非常短的时间，两个三极管均导通，产生较大的尖峰电流
### 其他TTL逻辑门
#### 与非门
![[Pasted image 20241011163711.png]]
该电路与反相器的唯一区别是将$T_1$换为了多发射极三极管，多发射极三极管就承担了与门的作用
#### 或非门
![[Pasted image 20241011164525.png]]
该电路就是两个反相器并联在同一个输出级上，并联承担了或门的作用；这种并联结构简记为两个相对的三极管
#### 与或非门
![[Pasted image 20241011164641.png]]
该门结合了上述两种门的结构；$Y=(AB+CD)'$
#### 异或门
![[Pasted image 20241011164952.png]]
$T_4=B$，$T_5=A$，得到$T_7=(A+B)'$
又$T_6=AB$，得到
$Y=(AB+(A+B)')'=(A'+B')(A+B)=A'B+AB'$
#### OC门
![[Pasted image 20241011165409.png]]
OC门就是TTL版本的OD门，输出端依然要外加一个电压
从而使得TTL电路中也可以实现线与功能

上拉电阻的计算与OD门相似，但是注意对于OC门来说$m$不一定等于输入端的数量，对于与输入端，低电平时输入电流乘上的是负载门的数量；
#### 三态门
![[Pasted image 20241011170540.png|400]]
三态门在CMOS部分已经介绍过，此略
### TTL系列的改进型
为了满足用户的要求，即提高工作速度和降低功耗两个方面，在74系列逻辑门电路的基础上，出现了74H系列、74S系列、74LS系列、74AS系列和74ALS系列。下面简单介绍它们的电路结构和电气特性。
1. 高速系列74H/54H
输出极采用达林顿结构
与74系列相比采用达林顿管，其β提高，输出高电平时输出电阻减小，缩短对负载电容的充电速度；电阻的减小使得电平的转换加快，故其平均传输延迟时间比74系列门电路缩短一半，通常为10ns以内。但电阻减小又使得功耗增大。
2. 肖特基系列74S/54S
在74S系列的门电路中采用抗饱和三极管
从而提高管子的开关速度，降低传输延迟时间
3. 低功耗肖特基系列74LS/54LS
传输延迟时间短,功耗降低
4. 74AS系列
电路和74LS系列相似，但采用低阻值电阻，故传输延迟时间较短，工作速度提高。但功耗要74LS系列的大些。
5. 74ALS系列
为了降低延迟－功率积，采用较高阻值电阻，缩小器件的尺寸，在电路也做了局部的改进。其DP积是74系列门电路中最小的一种。
# 组合逻辑电路
组合逻辑电路在任意时刻的输出仅仅取决于当时刻的输入信号。其特性可由一个方程描述：
$$
Y=F(X)
$$
## 组合逻辑电路的判读与设计
### 判读
给定一个组合逻辑电路，
1. 写出输出量相对于输入量的表达式
2. 依照表达式作出真值表
3. 总结功能
### 设计
给定一个目标组合逻辑电路的功能：
1. 写出目标输出的逻辑表达式，若不容易分析，列真值表后再写出表达式
2. 按照要求，将表达式化为不同形式（例如仅与非门）
3. 按照化得的表达式，构造电路
## 常见的组合逻辑电路
### 编码器
编码器将若干不同的输入转化为若干地址线上的编码
普通编码器任一同一时间只接受一个输入有效
优先编码器只对任意时刻优先级最高的输入编码，故而设计时需要考虑到优先级顺序的设计

常见的编码器芯片是优先编码器74HC148
它的标志见图4.1.1；其中$S'$为选通输入端，$Y_S'$为选通输出端；同时它还有一个拓展输出端$Y_{EX}'$；各输入里$I_7$优先级最高，依次下降
$S'=0$，编码器工作，$Y_S', Y_{EX}'$被锁定在高；
$S'=1$，编码器输出全为高，此时
在电路无输入时$Y_S'=0, Y_{EX}'=1$
在电路有输入时$Y_S'=1, Y_{EX}'=0$
### 译码器
译码器是编码器的逆向器件；以3线-8线译码器74HC138为例（图4.2.1）
注意该译码器中低电平是有效态；任意输出端的逻辑函数为：
$$
	Y_5'=A_2A_1'A_0S_1(S_2'+S_3')
$$
其额外的控制端亦见上；当$(S_2'+S_3')=1$时，可以看作以$S_1$为输入，$A_0,A_1, A_2$寻址的数据分配器；图4.2.2展示的二-十进制译码器也是类似工作原理，不过输入超过九的编码是非法的。
一种特殊的译码器是**显示译码器**，用来将数字显示在七段数码管上
### 数据选择器
数据选择器就是通过地址确定某一输入端的输入为输出器件；显然地，对于4线输入，就需要2线地址；一个简单的带开关二选一数据选择器的逻辑函数为：
$$
Y=(D_0A_0'+D_1A_0)S
$$
常见的数据选择器芯片是74HC153，它有两个4选1数据选择器单元，分别由一个控制端控制，它们公用一组地址线，各拉出一根输出端；
### 加法器
加法器是执行二进制加法的器件；基本器件是半加器，包含结果、进位两个输出端
$$
S=A \oplus B; CO=AB
$$
但是为了串接多个加法器，我们需要构建全加器，除了两个操作数之外，它还包括一个前进位输入接受一个来自前面一级的进位：
如此，我们可以串起多个全加器，得到串行多位加法器；它构造简单，但是缺点之一就是延迟高；另一种方法下，我们通过逻辑电路直接得出每一位的进位信号，不需要进位信号的传递，因此速度较快，称为超前进位加法器。
常见的全加器有双全加器74LS183和超前进位加法器74LS283
### 数字比较器
数字比较器可以用来比较两个二进制数的大小；依据比较数的大小关系分别在对应三种情况的不同输出端输出信号；
$$
Y_{A>B}=AB'; Y_{A<B}=A'B; Y_{A=B}=A\odot B
$$
将多个比较器串联就可以比较多位二进制数的大小；
常见的数字比较器有四位数值比较器74HC85，它有三端级联输入，用于承接上一个芯片输出的比较结果，仅当比较相等时，则输出只取决于级联输入

我们注意到，实际上数据选择器遍历了相应地址数大小的所有最小项，因此通过合理地连接数据选择器的端口，它可以模仿任何输入项数等于地址数的逻辑式的行为；
# 储存器
## 触发器
触发器是能够储存一个比特信号的基本单元电路。
按触发方式分为：
1. 无触发
2. 电平触发
3. 边沿触发
4. 脉冲触发
按逻辑功能分为：
1. SR锁存器
2. JK触发器
3. D触发器
4. T触发器
### SR锁存器
两种经典的SR锁存器见图册
对于高电平有效的SR锁存器：
当$S/R=0/0$时，$Q^\ast = Q$；
当$S/R=1/0$时，$Q^\ast=1$；
当$S/R=0/1$时，$Q^\ast=0$；
当$S/R= 1/1$时，$Q^\ast$不定；时序图上用阴影表示。

对于电平触发的SR锁存器，仅当时钟信号$CLK=1$时，SR有效；否则输出保持原状态；有些场合需要在时钟到来之前先将触发器置为指定状态，因此配备了异步SR端，它们能无视时钟信号将触发器强行置位。
异步置位端常记为$S_D, R_D$

**电平触发方式的动作特点**：在$CLK=1$的全部时间内触发器使能，而当时钟信号在$t=t_0$时刻跳变为$CLK=0$后，就保持跳变前瞬间$t_0^-$触发器的状态。

显然的，如果在时钟高电平时段内SR多次变化，则输出有可能出现空翻现象；实际应用中，要求触发器在每个时钟信号作用期间状态仅发生一次改变；因此，电平触发方式的抗干扰能力较低。
为了避免空翻现象，在此基础上设计出脉冲触发的SR触发器（主从SR触发器）。它由一个主触发器和一个从触发器串接而成，并且它们的时钟信号反相，因此二者不会同时使能。
若主触发器的时钟信号为$CLK$，从触发器的时钟信号为$CLK'$，则当$CLK=1$时，主触发器使能而从触发器锁定，输入信号只能传导至两级触发器之间；若随后CLK跳变为0，则此时主触发器锁定，从触发器使能，将此时两级之间的信号输出，因此一个时钟周期仅发生一次状态改变。

**脉冲触发方式的动作特点**：在$CLK=1$的全部时间内主触发器使能，而从触发器锁定并保持上个周期的输出。当时钟信号在$t=t_0$时刻跳变为$CLK=0$后，主触发器保持跳变前瞬间$t_0^-$的状态，从触发器使能，状态改变，输出主触发器所保持的状态。
整个周期内仅发生一次状态改变。
脉冲触发（下边沿）在电路图上表示为倒L形的折角标志。

脉冲触发方式克服了一个周期内触发器状态空翻的问题，但是主触发器的空翻依然存在，且存在不定态。
### D触发器
为了适应单端输入的需要，有时用一个非门实现$R=S'$的关系，而将改造后的$S$端称为D端，改造后的触发器称为D触发器
此时，触发器不会出现不定状态（S/R=1/1），但是也失去了保持状态的能力（S/R=0/0）。
为了提高触发器工作的可靠性，因此希望触发器的次态仅决定于时钟边沿到来时输入的状态，因此出现了各类边沿触发器。
由于D触发器失去了保持状态的能力，因此使用D触发器构造脉冲触发器就不取决于整个脉冲有效段输入的变化情况，而仅取决于边沿处输入的情况，也就是可以构成边沿触发器。
请注意：边沿触发从电路构造上看就是脉冲触发，但它之所以能够仅取决于边沿处的输入，是因为使用了没有保持状态功能的D触发器。

**边沿触发的动作特点**：触发器的次态仅与时钟边沿时刻的输入有关
电路图上用时钟端的小三角表示上升沿触发，而加上取反圈就得到下降沿触发。
### JK触发器
为了使主从SR触发器在SR=11时也能有定态，将输出Q与Q'反馈回输入端，构成的触发器称为主从JK触发器。在SR=0时，其与主从SR触发器一致，但当SR=1时有$Q^\ast = Q'$（注意这是J/K恒定时的状态）
在有些JK触发器中不止一对JK端子，这些输入端子是与的关系
由于输出信号的反馈，在一个周期中主触发器的状态也只可能翻转一次，当Q=0时有Q'=1，此时K的信号无法进入主触发器，仅有J=0的信号能够进入主触发器，因此主触发器的输出或翻转一次后保持或不翻转
，总之仅改变一次；Q=1时类之（克服了空翻现象）
但是也正是因为克服了空翻现象，考虑Q=0时干扰信号使J=1了一段时间，则此时主触发器仅聆听J端输入并且已经翻转，尽管输入的可能是J/K=0/0；因此，主从JK触发器的抗干扰性依然较差。
### 触发器的逻辑功能
以上各个触发器的逻辑功能分别描述为：
1. SR锁存器：$Q^\ast = S+R'Q(SR=0)$
2. JK触发器：$Q^\ast = JQ'+K'Q$
3. D触发器：$Q^\ast=D$
4. T触发器：$Q^\ast=TQ'+T'Q$
5. T'触发器：$Q^\ast = Q'$
通过合适的连接，可以将触发器相互转换

在实际使用中，对于市面上售卖的集成触发器，须要了解其触发种类、逻辑分类才能较好地使用之。
## 存储器
存储器是能够储存大量比特的器件，通常由地址译码器、存储矩阵和输入输出电路构成。
按存取功能分为：
1. 只读存储器ROM
2. 随机访问存储器RAM
### ROM
有些ROM使用二极管进行地址译码和数据存储。
地址线上的信号被二极管与门翻译为字线上的信号，而每条字线都可以在存储阵列中读出一组信号，将读出的数据输出到位线上。
因此，存储器的容量就等于字线数乘以位线数。
对于$N$位地址的ROM，每一根位线输出可以用来模拟一个$N$输入逻辑门，$M$根位线就可以用来描述$M$个$N$输入逻辑门。
# 时序逻辑电路
任意时刻的输出不仅取决于当时刻的输入信号，还取决于电路原先的状态。其特性由三个方程描述：
$$
Y=F(X, Q), Z=G(X, Q), Q^\ast = H(Z, Q)
$$
分别称为输出方程、驱动方程和状态方程；
根据其触发特点可以分为同步时序逻辑电路和异步时序逻辑电路；
根据其操作特点可以分为米利型和穆尔型时序逻辑电路；
## 常用的时序逻辑电路
### 移位寄存器
移位寄存器由一串边沿动作的D触发器串接构成，该串的一端作为串行输入端，另一端作为串行输出端；所有D触发器统一于一个时钟信号CLK，并且所有D触发器间抽线得到并行输出。
在每个时钟周期，移位寄存器释放最后一比特数据并且接收一个比特的新数据，所有数据向串行输出移动一位。
实际操作中常用的移位寄存器有双向移位寄存器74LS194A，它有两个控制端$S_1, S_0$和置零端$R_D'$；记$S=S_1/S_0$，则：
1. $S=0/0$时保持
2. $S=0/1$时右移
3. $S=1/0$时左移
4. $S=1/1$时允许并行输入
### 计数器
计数器由一串边沿动作的T触发器串接构成，而每一个触发器当且仅当在它以下的所有触发器全部为高位时才触发，从而实现计数功能
给定一个已知进制的计数器，可以使用置零法、置数法构造任意进制的计数器，对于目标进制小于的，置零、置数即可，否则需要用多片计时器配合置数法使用

将移位寄存器的出线接回进线，则构成了环形计数器，但是注意环形计数器的有效状态是存有$00\dots 01$的状态，其它状态都是无效状态，且不能自启动
将移位寄存器的反相出线接回进线，则构成了扭环形计数器，它的计数循环更长，但是依然不能自启动；通过反馈逻辑电路可以将无效循环打断，从而实现自启动
# 脉冲波形的产生和整形电路
在实际操作中我们时常需要产生矩形脉冲波；其产生途径有：
1. 利用各种振荡电路直接产生
2. 利用已有的周期信号通过整形产生
矩形脉冲波的波形如图7.1.1，其中：
脉冲周期就是矩形脉冲波的最小正周期$T$；
脉冲波在一段长$T$的时间内的波形称为基本波形；
脉冲频率$f=1/T$，就是单位时间内基本波形的个数；
脉冲幅度就是脉冲波最大值和最小值之差$V_m$；
脉冲宽度$t_W$是脉冲波从一个上升沿半幅处到紧跟着的下一个下降沿半幅处的时间差；
上升时间$t_r$是上升沿自10%幅度上升到90%幅度所需时间；
下降时间$t_f$是下降沿自90%幅度下降到10%幅度所需时间；
占空比$q=t_W/T$
## 施密特触发电路
### 门电路构成施密特触发电路
将两级反相器串接起来，并将输出端电压反馈回输入端就得到施密特触发器电路，如图7.2.1
当输入电压升高到一定程度后发生正反馈，导致输出电压急速上升；反之，导致输出电压急速下降；因此，可以生成升降时间很短的脉冲波；
电压升高过程中输出跳变的阈值电压记为$V_{T+}$；电压下降过程中输出跳变的阈值电压记为$V_{T-}$；
可以推知：
$$
V_{T+}=\frac{R_2+R_1}{R_2}V_{TH},V_{T-}=\frac{R_2-R_1}{R_2}V_{TH}
$$
二者之差称为回差电压：
$$
\Delta V_T=2\frac{R_1}{R_2}V_{TH}
$$
施密特电路有同相和反相之别，区别就在于输出电压和输入电压的关系
### BJT构成施密特触发电路
电路图如图7.2.2
当$v_I=0$时，$T_1$截止，$T_2$导通；
当$v_I$升高时，$T_1$逐渐导通，$v_{C1}$减小，$T_2$逐渐截止，导致$v_E$逐渐下降，推动$T_1$进一步导通（正反馈）；
其缺点就是$T_2$饱和导通时，输出电压是电源电压的分压，因此产出的逻辑低电平不标准。
因此在TTL集成施密特触发电路 7413中，增添了电平偏移级，同时采用推拉式输出；
### 施密特触发器的应用
1. 波形变换
施密特触发器可以将缓慢变化的周期波形转换为矩形脉冲；
2. 脉冲整形
施密特触发器常常用来对传输过程中被干扰的数字信号进行整形，从而获得比较理想的波形；噪声例如：寄生电容造成的边沿伸展，阻抗不匹配造成的毛刺和附加噪声等
3. 鉴幅
可将一系列幅度不同的信号中幅度大于正向阈值电压的脉冲筛选出来
## 单稳态触发电路
单稳态触发电路有一个稳态和一个暂稳态，在外界触发作用下能够实现从稳态到暂稳态的跃迁，一段时间后自动回到稳态；
### 门电路组成的单稳态触发器
单稳态触发器的暂稳态常常是通过RC电路充放电实现的，有微分型和积分型两种；
1. 微分型
电路图见7.3.1
无输入电压时，电路处于稳态；当$v_d=V_{TH}$时，或非门输出跳变为低，输出翻转为高，电路进入暂稳态，并且中间电容开始充电。此时若输入脉冲结束，则中间电容充电到一定水平后，引发另一个正反馈，使得输出翻转为低；否则，输出脉冲的下降沿较差；
其中脉冲宽度$t_W=RC\ln 2=0.69RC$，回复时间$t_{re}=(3\sim 5)RC$，分辨时间$t_d=t_W+t_{re}$；
输出的脉冲幅度约等于输驱动电压；
2. 积分型
电路图见7.3.2
无输入电压时，电路处于稳态，输出高电平；有正脉冲输入后，电路进入暂稳态；中间电容逐渐放电，输出翻转为低电平；此时若输入脉冲结束，则电容重新开始充电，输出再次翻转为高电平；可见，积分型电路中没有正反馈，纯粹是靠电容的充放电实现翻转；
脉冲宽度为：
$$
t_W=(R+R_0)C\ln\frac{V_{OL}-V_{OH}}{V_{OL}-V_{TH}}
$$

总的来看，微分型电路要求输入脉冲较窄，不至于干扰到复位正反馈；由于正反馈的影响，边沿较为理想，但是抗干扰能力差；积分型则反之，要求输入脉冲宽于输出脉冲（给电容放电到阈值电压之下的机会）；同时没有正反馈，因此抗干扰能力强而边沿较差；

集成单稳态触发器74121在微分型的基础上加上了输入控制电路和输出缓冲电路；其功能表见图7.3.3

单稳态触发器不可重复触发和可重复触发型；对于不可重复触发型，一旦进入暂稳态，它就不再接受触发脉冲，直到恢复稳态；而对于可重复触发型，即使进入暂稳态，如果接收到一个触发脉冲，则它被重新触发，输出脉冲再维持一个宽度；
### 单稳态触发器的应用
1. 脉冲延时
单稳态触发器可以用来给脉冲延时一个宽度
2. 脉冲定时
单稳态触发器可用来控制另一个电路，使它在一个宽度内工作或不工作
## 多谐振荡器
多谐振荡器时一种自激振荡器，由于产生的矩形波中含有高次谐波，故而称为多谐振荡器。
### 对称式多谐振荡器
电路图见7.4.1
振荡周期：
$$
T=2T_1=2R_EC\ln\frac{V_{E1}-V_{IK}}{V_{E1}-V_{TH}}
$$
其中$$V_{E1}=V_{OH}+(V_{CC}-V_{BE}-V_{OH})\frac{R_{F2}}{R_1+R_{F2}}, R_{E1}=R_1\parallel R_{F2}$$
### 非对称式多谐振荡器
电路图见7.4.2
此时，反相器选取CMOS反相器，工作点设置在转折区的中点
设置$v_{I1}$为$0.5V_{DD}$。当$v_{I1}$发生正扰动，$v_{O1}$大幅下降，导致$v_{O2}$大幅上升至高电平，此时电容$C$充电。
### 环形多谐振荡器
电路图见7.4.3
任意大于3的奇数个反相器环形串联都得到环形多谐振荡器，若有$n$个反相器，则环形振荡器的周期为：
$$
T=2nt_{pd}
$$
其中$t_{pd}$为反相器的延迟时间；

为了不用过多的反相器而能够减小振荡器的频率，可以在反相器之间加设RC积分环节；为了进一步延长周期，将电容的一端从地上改接到本级反相器的输入（电路图见7.4.4）。振荡周期为：
$$
T\approx2.2RC
$$
其中$R$应当远小于$R_1+R_S$，而通常改变$R, C$来更改频率
### 施密特触发器构成多谐振荡器
电路图见7.4.5
$v_I=0$，从而$v_O=V_{OH}$，给电容充电，当$v_I=V_{T+}$后，输出跳变为$v_O=V_{OL}$，电容放电；如此循环
振荡周期：
$$
T=RC\ln\left[\frac{V_{DD}-V_{T-}}{V_{DD}-V_{T+}}\cdot\frac{V_{T+}}{V_{T-}}\right]
$$
若要调节占空比，则可改造$R$，使它在充放电过程中有不同电阻即可。
## 555定时器
555定时器的结构图和功能表见图7.5.1
总的来说可以总结为：都大为0，都小为1，一小一大是保持
利用555定时器，可以构造许多电路
### 构造施密特触发电路
按照图7.5.2所示构造电路
可以看出上临界电压为$\frac 23 V_{CC}$，下临界电压为$\frac 13 V_{CC}$
当$v_I>\frac 23 V_{CC}$，输出低电平，现在降低电压，则有$V_{T-}=\frac 13 V_{CC}$；反之，当$v_I < \frac 13 V_{CC}$，输出高电平，现在升高电压，则有$V_{T+}=\frac 23 V_{CC}$
从而构成了施密特触发器

考虑5号引脚采用外接参考电压$V_{EXT}$，此时上临界电压为$V_{EXT}$，下临界电压为$0.5 V_{EXT}$；则构成施密特触发器的阈值有不同
### 构造单稳态触发电路
按照图7.5.3所示构造电路
输入$v_I>\frac 13 V_{CC}$时，$v_O=0$，放电三极管导通（稳态）
此时6引脚的输入电压为0，上运放输出低电平；2引脚的输入电压大于下临界电压，下运放也输出低电平；
若通电时$v_O=1$，此时放电三极管截止，电容充电至$V_{CC}$，过程中由于6引脚电压大于上临界电压，上运放输出高电平，输出跳变为$v_O=0$（复位过程）
当$v_I<\frac 13 V_{CC}$时，下运放输出高电平，输出跳变为$v_O=1$，随后按照复位过程回归稳态；
不难计算，一次脉冲的时间为：
$$
T=RC\ln 3
$$
### 构造多谐振荡电路
按照图7.5.4所示构造电路
其思想是按照施密特触发器构造多谐振荡器的方法改造上一节所述电路即可；
# D-A和A-D转换
## 数模转换
下面是一些常见的数模转换电路：
1. 权电阻网络转换器
![[Pasted image 20240703133959.png|500]]
其缺点是所用的电阻阻值范围太大，就导致难以构建多位的转换器
2. 倒T形网络转换器
倒T形网络转换器克服了权电阻网络电阻阻值变化过大的这一缺点
![[Pasted image 20240703141622.png|500]]

数模转换器的转换精度计算为最小分辨电压比上最大输出电压；理论上$n$位数模转换器的转换精度（分辨率）为$(2^n-1)^{-1}$；实际上由于转换误差的存在，并不能简单认为实际精度就是分辨率；
转换误差常常用最小分辨电压$LSB$衡量
实际的转换误差包括比例系数误差（$V_{REF}$波动）、平移误差（运放零点漂移）和非线性误差
其中，比例系数误差根据转换公式：
$$
V=2^{-n}V_{REF}\sum_{i=0}^nd_i2^i
$$
可知其误差正比于$\Delta V_{REF}$
## 模数转换
（**取样定理**）为了保证能够从数字信号中恢复出模拟信号，应当保证采样频率大于等于输入模拟信号最高频率分量的两倍，一般取3至5倍
为了将模拟信号转化为数字信号，要求我们对模拟信号作出量化。量化过程的最小分辨率称为量化单位。下面是两种划分量化电平的方式。
![[Pasted image 20240703153515.png]]
如果采用方法一进行量化，则量化误差最大为$\Delta$.
如果采用方法二进行量化，则量化误差最大仅为$0.5\Delta$，因为此时转换出的模拟电压位于每一个量化电平的中间.
下图是并联比较型A/D转换电路
![[Pasted image 20240703154235.png||500]]
理论上一个$n$位的A/D转换器能区分$2^n$个等级的输入电压；其分辨率为$2^{-n}$

